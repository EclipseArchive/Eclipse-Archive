<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eclipse Archive: Guest</title>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: black;
            color: white;
            font-family: 'Source Code Pro', monospace;
            padding: 20px;
        }
        .terminal {
            position: absolute;
            top: 20px;
            left: 20px;
            white-space: pre-line;
        }
        .blink {
            animation: blink 1s step-end infinite;
        }
        @keyframes blink {
            50% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="terminal" id="terminal"></div>
    <script>
        function animateDots(text, duration, callback) {
            const terminal = document.getElementById("terminal");
            let count = 1;
            let dots = setInterval(() => {
                terminal.innerHTML = text + ".".repeat(count);
                count = count % 3 + 1;
            }, 333);
            setTimeout(() => {
                clearInterval(dots);
                callback();
            }, duration);
        }

        function loadingScreen() {
            const terminal = document.getElementById("terminal");
            animateDots("LOADING USER ENVIRONMENT", 2000, () => {
                terminal.innerHTML = "LOADING USER ENVIRONMENT... \n--------------------------------------\n";
                setTimeout(() => {
                    terminal.innerHTML += "- Setting up secure session\n";
                    setTimeout(() => {
                        terminal.innerHTML += "- Loading user preferences\n";
                        setTimeout(() => {
                            terminal.innerHTML += "- Checking system updates\n\n";
                            showProgressBar();
                        }, 1000);
                    }, 1000);
                }, 1000);
            });
        }

        function showProgressBar() {
            const terminal = document.getElementById("terminal");
            let progress = 0;
            const steps = [13, 26, 39, 52, 65, 78, 91, 100];
            let interval = setInterval(() => {
                if (progress >= steps.length) {
                    clearInterval(interval);
                    terminal.innerHTML += "\nSystem Ready.\n";
                    setTimeout(startCommandPrompt, 500);
                    return;
                }
                let percent = steps[progress];
                let bar = "[" + "#".repeat(percent / 5) + "-".repeat(20 - percent / 5) + "] " + percent + "%";
                terminal.innerHTML += bar + "\n";
                progress++;
            }, 500);
        }

        function startCommandPrompt() {
            document.getElementById("terminal").innerHTML = "";
            displayCommandLine();
        }

        function displayCommandLine() {
            const terminal = document.getElementById("terminal");
            terminal.innerHTML += "X:\\Archive\\Users\\Guest> <span id='commandInput'></span><span class='blink'>_</span>";
            listenForCommand();
        }

        function listenForCommand() {
            let command = "";
            const terminal = document.getElementById("terminal");
            document.addEventListener("keydown", function handleInput(event) {
                if (event.key.length === 1) {
                    command += event.key;
                } else if (event.key === "Backspace") {
                    command = command.slice(0, -1);
                } else if (event.key === "Enter") {
                    document.removeEventListener("keydown", handleInput);
                    processCommand(command.trim());
                    return;
                }
                document.getElementById("commandInput").textContent = command;
            });
        }

        function processCommand(command) {
            const terminal = document.getElementById("terminal");
            terminal.innerHTML += "\n";

            if (command === "test") {
                terminal.innerHTML += "Hello world\n";
            } else if (command === "list") {
                terminal.innerHTML += "Documents: (Coming soon...)\n";
            } else if (command === "logout") {
                animateDots("Logging out", 2000, () => {
                    terminal.innerHTML += "\nSuccessfully Logged Out.\n";
                    setTimeout(() => {
                        window.location.href = "index.html";
                    }, 500);
                });
                return;
            } else if (command === "help") {
                terminal.innerHTML += "Available Commands:\n";
                terminal.innerHTML += " • test   - Prints 'Hello world'\n";
                terminal.innerHTML += " • list   - Lists documents (coming soon)\n";
                terminal.innerHTML += " • logout - Logs out and returns to login\n";
                terminal.innerHTML += " • help   - Shows this help message\n";
            } else {
                terminal.innerHTML += "Unknown command. Type 'help' for a list of commands.\n";
            }

            terminal.innerHTML += "\nX:\\Archive\\Users\\Guest> <span id='commandInput'></span><span class='blink'>_</span>";
            listenForCommand();
        }

        loadingScreen();
    </script>
</body>
</html>
